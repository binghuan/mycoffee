<!DOCTYPE html>
<!--<html manifest="mycoffee.appcache">-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">

    <link rel="SHORTCUT ICON" href="icon/mycoffee.ico" >
    <link rel="shortcut icon" sizes="128x128" href="icon/mycoffee-128.png">
    <link rel="shortcut icon" sizes="196x196" href="icon/mycoffee-196.png">
    <link rel="apple-touch-icon" href="icon/mycoffee-64.png">
    <link rel="apple-touch-icon" sizes="76x76" href="icon/mycoffee-76.png">
    <link rel="apple-touch-icon" sizes="120x120" href="icon/mycoffee-120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="icon/mycoffee-152.png">

    <link rel="stylesheet" href="css/jquery.mobile-1.4.3.min.css"/>
    <title>My Coffee</title>
    <style>
        .ui-icon-pin {
          background: url("images/pin.png") 50% 50% no-repeat;
          background-size: 18px 18px;
          width: 18px;
          height: 18px;
          box-shadow: none;
          -webkit-box-shadow: none;
        }
        
        .page-map, #map-canvas { 
            width: 100%; 
            height: 100%; 
            padding: 0; 
        }
    </style>
</head>
<body>
    <!-- main page -->
	<div data-role="page" id='index'>
		<div data-role="header" data-theme='b'>
			<a id="pinButton" data-ajax="false" data-role="button" data-theme='c' href='javascript:(function(){var newUrl = location.href.replace("food.html", "pinSetting.html") + "?url=" + location.href + "&icon=icon/food.png&fontColor=white&label=Food Finder"; sessionStorage.PIN_TILE_STAY = "1";console.log("navigate to " + newUrl); location.href = newUrl;})()' class="ui-btn-right" data-icon="pin" data-iconpos="left">Pin</a>
			<h1>My Coffee</h1>
		</div>

        <input type="search" name="postcode" id="searchbox" value="" placeholder="搜尋範例: 台北 咖啡"/>
        <div class="ui-grid-a">
            <div class="ui-block-a">
                <select id="selectRangeCondition"  class='ui-block-a'>
                    <option value="500">&lt; 0.5公里</option>
                    <option value="1000">&lt; 1公里</option>
                    <option value="2000">&lt; 2公里</option>
                    <option value="5000">&lt; 5公里</option>
                    <option value="10000" selected>&lt; 10公里</option>
                </select>
            </div>
            <div class="ui-block-b">
                <input id="searchButton" type="button"  data-icon="search" value="開始搜尋" class='ui-block-b'>
            </div>
        </div>

		<div data-role="content" id="content">
            <div class="ui-grid-b">
                <div class="ui-block-a">
                    <h2>目前位置:</h2>
                </div>
                <div class="ui-block-b">
                    <h2 id="addressInfo"></h2>
                </div>
                <div class="ui-block-c">
                    <button id="updateLocation" data-role="button" data-icon="refresh">更新位置</button>
                </div>
            </div>

            <div id="messageBar">
                <h2 id="messageText" style="margin-left:10px;margin-right:auto;display: inline"></h2>
                <h2 id="searchResultText" style="margin-left:10px;margin-right:auto;display:inline"></h2>
            </div>
            <p></p>
			<ul id="listView" data-role='listview' data-count-theme='b'></ul>
		</div>

		<div data-role="footer" data-position='fixed' data-theme='b'>
			<div>
				<p align="center">
					Powered by BH_Lin &amp; Powen_Tan
				</p>
			</div>
		</div>
	</div>
    <!-- gmap page -->
    <div data-role="page" id="gmap" class='page-map'>
		<div data-role="content" id="content" style="height: 100%; width: 100%">
            <div id="map-canvas"></div>
        </div>
    </div>

    <script type="text/tempalte" id="store-item" charset="utf-8">
        <!-- <li data-role="list-divider"> -->
            <!-- <h2>{{name}}</h2> -->
            <!-- <span class="ui-li-count"> -->
                <!-- {{distance}} -->
            <!-- </span> -->
        <!-- </li> -->
        <li>
            <h1 class="ui-li-heading">
                {{name}}
            </h1>
            <span class="ui-li-count">
                {{distance}}
            </span>
            <p>
                <a href="http://maps.google.com.tw/?q={{address}}" target="_blank">
                    {{address}}
                </a>
            </p>
            <!-- <p class="ui-li-desc" style="white-space: normal;">推廌餐點:{{menu}}</p> -->

            <p class="ui-li-desc">營業時間:
                {{openTime}}
            </p>
            <!-- <p class="ui-li-desc" style="white-space: normal;">ps:  {{remark}}</p> -->

            <p class="ui-li-desc">電話:
                <a class="goog_qs-tidbit goog_qs-tidbit-0" href="tel:{{phone}}">
                    {{phone}}
                </a>
            </p>
        </li>
    </script>

    <script src="lib/jquery-1.11.1.min.js"></script>
    <script src="lib/jquery.mobile-1.4.3.min.js"></script>
    <script src="lib/mustache.js" type="text/javascript" charset="utf-8"></script>

	<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?key=&sensor=true"></script>
    <script src="gmap.js" type="text/javascript" charset="utf-8"></script>
    <script src="dataList.js"></script>
    <script type="text/javascript">
        function initialize(mapID, mapCSS) {
            if(mapCSS == null) {
                $('#' + mapID).css({height: '100%'});
            } else {
                $('#' + mapID).css(mapCSS);
            }
            // new a map
            window.gmap = new GMap(mapID);

            // detect current location
            window.gmap.setCurrentLocation();
        }

        $(function() {
            initialize('map-canvas', {
                width: '100%',
                height: '100%',
                position: 'absolute'
                // ,float: 'right'
            });
            initialize('map-canvas');

            // set markers
            dataList.forEach(function(location) {
                window.gmap.addMarkers([location], {
                    icon: 'icon/mycoffee-40.png'
                });
            });

            // bind events
            $('button#removeMarker').on('click', function() {
                window.gmap.clearMarkers();
            });
            $('button#route').on('click', function() {
                var start = window.current_pos;
                GMap.utils.geocode($('#endPos').val()).done(function(end) {
                    window.gmap.route(start, end);
                });
            });
        });
    </script>
    <script src="mycoffee.js"></script>
</body>
</html>
